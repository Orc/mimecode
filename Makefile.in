#
# makefile for unravel
#

CC=@CC@
CXX=@CC@
CFLAGS += @CFLAGS@
CXXFLAGS=$(CFLAGS)

BINDIR=@exedir@
MANDIR=@mandir@

MANPAGES=ravel.1 unravel.1 uudecode.1 uuencode.5
PROGS= ravel unravel

OBJS=version.o qp.o base64.o uudecode.o clear.o openfile.o

all: $(PROGS)

ravel: ravel.o $(OBJS) @OPTIONS@
	$(CC) $(CFLAGS) -o ravel ravel.o $(OBJS) @LIBS@ @OPTIONS@

unravel: unravel.o $(OBJS) @OPTIONS@
	$(CC) $(CFLAGS) -o unravel unravel.o $(OBJS) @LIBS@ @OPTIONS@

version.c: config.h
	echo 'char version[] = "@VERSION@";' > version.c
clean:
	rm -f ravel unravel *.o

distclean spotless: clean
	rm -f @CONFIGURE_FILES@ @GENERATED_FILES@ version.c

install: install.bin install.man

install.bin: $(PROGS)
	@INSTALL_DIR@ $(DESTDIR)$(BINDIR)
	@INSTALL_PROGRAM@ $(PROGS) $(DESTDIR)$(BINDIR)
	ln -fs unravel $(DESTDIR)$(BINDIR)/uudecode

install.man: install_manpages $(MANPAGES)
	./install_manpages $(MANDIR) $(DESTDIR)$(MANPAGES)

$(OBJS): config.h mime_encoding.h
